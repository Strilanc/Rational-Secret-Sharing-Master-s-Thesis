\documentclass{article}
\usepackage{textcomp}

\title{Resilient Secret Sharing Protocols}
\author{Craig Gidney}
\date{\today}

\begin{document}
\maketitle

\section{Introduction}

Secret sharing protocols that are resilient to various factors (rational players, irrational players, coalitions, lack of synchronous broadcast, \ldots).

\subsection{Secret Sharing}

A secret sharing algorithm allows some data D to be split into N shares such that any set of K-1 shares reveal no information about D but any set of K shares can be used to easily compute D.

Having a secret sharing algorithm is not enough. There are practical considerations.

Suppose a database containing financial predictions is protected by a key distributed amongst various investment firms. The firms want to combine their shares, but one firm transmits a fake share and ends up having sole access to the information and corners the market. Alternatively, the chance of a firm cornering the secret prevents all of the firms from commiting to combining the secret shares.

Also consider a will for a large fortune being encrypted by a key distributed to various potential heirs in a huge family, with the caveat that if the heirs can't reconstruct the key then the fortune will be distributed evenly. Some of the heirs knows the deceased hated them, and that they will get nothing in the will. So they all agree to send fake shares, with the knowledge that finding a valid set of shares is computationally difficult (e.g. have 100 shares, need 80, 10 are fake, (20 choose 10) / (100 choose 80) ~= 1 out of a hundred quatrillion chance of success).

\subsection{Results / Goals}

We want to create a secret sharing protocol which continues to work with different types of players. I consider a few types of players:

- Rational: Wants to learn the secret, but secondarily wants to prevent or delay others from learning the secret.
- Irrational: Wants to prevent or delay others from learning the secret (e.g. a rational player who has previously learned the secret)
- Colluding: Players may form coalitions to further their goals. I consider only homogeneous non-overlapping coalitions (either rational or irrational).

Consider how naive protocols may fail for these players:
- Rational players will not send their shares if the last round is known.
- If shares are not authenticated, irrational players can send garbage to make finding K valid shares out of N exponentially hard.
- If the last round is not hidden, rational players will choose the weakly dominant strategy of not sending their shares.

A synchronous transmission algorithm with optimal resilience against all player types and non-overlapping coalitions.

Exploring limitations of asynchronous algorithms.

Non-synchronous transmission

Non-overlapping homogeneous coalitions

Honest, rational, irrational players

\section{Previous Work}

Shortcommings:

- Reliance on sharer interaction
- Reliance on synchronous broadcast
- Fails for important corner cases like N=M or N=2
- Use full blown multi party computation (what if we want to enable MPC with secret sharing? Is that done?)
- Non-optimal resource usage


\subsection{Rational secret sharing and multiparty computation: extended abstract}
Proves there is no finite bound on the number of rounds by deleting weakly dominated strategies.

Introduces a 3 of 3 protocol with finite expected number of rounds.

Extends to an m of n protocol (n > 2, n >= m).

The protocol has the issuer giving out new shares of the secret each round. Requiring the presence of the issuer defeats the purpose of secret sharing, because the shares become unnecessary. Just have the issuer give out the secret when enough players indicate they want the secret revealed.

Assumptions about utility functions.

Uses synchronous broadcast.

\subsection{Collusion Free Protocol for Rational Secret Sharing}

Uses synchronous broadcast.

\subsection{Games for Exchanging Information}

Short list long list. Short player knows definitive round, long player has value but doesn't know which. O(t) information shared!

\subsection{Fairness with an Honest Minority and a Rational Majority}

\subsection{Rational Secret Sharing with Repeated Games}
Poor quality paper.
Covers asynchronous case.
But assumes the dealer is present for all rounds, allowing ack optimization.

\subsection{The deterministic protocol for rational secret sharing}

\subsection{How to Share a Secret}
Shamir's (and who?) secret sharing protocol uses polynomials over finite fields. For a secret requiring M shares to reveal, the sharer generates a random M-1 degree polynomial with the secret stored in the y value at x=0. The ith share is the value of the polynomial at x=i. Polynomial interpolation of an (M-1)th degree polynomial requires M points, and fewer points allow any value at 0 (clearer...).

This scheme has several benefits:
\begin{itemize}
	\item Secure. Given m-1 shares, every y value at x=0 is equally likely. (Why?)
	\item Extensible. New shares can be introduced without modifying or weakening the old shares. Players don't even need to know how many shares there are in total or who has what shares.
	\item Compact. Optimal amount of information per share. Each player gets an amount of information equal to the information required to store the secret. (This is optimal because if a share had less information than the secret, m-1 shares would be able to know something about the secret based on fewer possible remaining shares than secrets.)
	\item and...?
\end{itemize}

\subsection{paper using homomorphic encryption to emulate ack-ing\ldots}
Emulating a trusted intermediary with homomorphic encryption. Works for 2 players.

Very expensive. Implementation details very complicated? Relies on multi party computation (is secret sharing supposed to enable more efficient multi party computation?).

\section{Common Assumptions In Previous Work}
\subsection{Cryptographic Primitives}

Multiparty computation, homomorphic encryption (these are not really assumptinos so much as complicated implementation details)

\subsection{Rational Adversaries}

At most one rational coalition with size less than m. (I want to consider irrational and rational coalitions.)

\subsection{Synchronous Broadcast}
Existing algorithms (check!) all depend on synchronous broadcast. In other words, they assume players can communicate such that:
\begin{itemize}
\item Obliviousness.

	No player can receive a round's messages before sending their own round message. This prevents waiting to receive all messages and confirming it is not the last round before sending your own message, resulting in a deadlock due to all players waiting on each other.

\item Reliability.

	Messages are never mangled or lost. Receiving a message is equivalent to a player sending that message. This prevents confusing non-participating players with unlucky players.

\item Cross-consistency.

	Players can't send differing messages to different players (at least on the broadcast channel). This prevents byzantine complications in some protocols. (How often is this relied upon? Is it necessary?)
\end{itemize}

I will cover some methods of removing syncrhonous broadcast assumptions.

\section{Types of Players and Coalitions}

\begin{itemize}
  \item Honest
  \subitem Tries to follow the protocol exactly.
  \subitem Doesn't participate in coalitions.
  \subitem M of N with H honest players is equivalent to (M-H) of (N-H) with 0 honest players.
  \item Irrational
  \subitem Wants to prevent others from learning the secret. Doesn't care if they themselves learn the secret.
  \subitem Irrational coalitions don't care if their members learn the secret.
  \item Rational
  \subitem Wants to learn the secret above all else and, secondarily, wants to prevent others from learning it.
  \subitem Rational coalitions of size C are similar to a rational player with C puppets.
  \subitem Rational coalitions of size M or more are equivalent to irrational coalitions. 
\end{itemize}

\begin{itemize}
  \item Assume irrational coalitions don't attempt to deny their own members access to the secret, in order to allow them to be strong. 
  \item Mixed rational/irrational coalitions are not equivalent to pure rational or pure irrational coalitions.
  \item If irrational opponents can prove to others when the last round occurs, before it does, the rational players will not participate.
  \item Irrational coalitions with at least M members know when the last round occurs.
  \item Irrational coalitions have two strategies against our algorithm: target m-1 or target m-2. Targeting m-1 requires fewer sacrifices but is not cooperative with other irrationals and only prevents m-1 non-irrationals from learning the secret. Targeting m-2 is cooperative with other irrationals but only works if there are n-m+1 irrationals.
  \item Rational coalitions have the omit-last-send-when-you-can strategy.
  \item 
\end{itemize}
Opponents are organized into coalitions, which freely share information amonst themselves in order to further their goals. Simple results:

What about coalitions of half rational half irrational players? Do they always categorize as rational or irrational? NO: The rationals won't sacrifice themselves for the good of the coalition, because they will then be excluded.

- If it is possible to prove when the last round occurs without revealing the secret, the irrational opponents can do so in order to cause the rational opponents to stop playing.
- If an irrational coalition has more than m members, they know when the last round occurs.
- If the irrational opponents know there are fewer than n-m non-irrational players, they will all stop playing so the secret will not be learned.
- m rational or honest players will learn the secret if there is synchronous broadcast.
- m honest players will learn the secret if messages are verifiable.
- coalitions are significantly less powerful if they don't have the n-m majority. Not clear how multiple coalitions affect the result.

\section{Proposed Algorithm for Synchronous Broadcast}
\subsection{Dealer Protocol}
\begin{itemize}
	\item Generate a commitment to the secret and a nonce
	\item Generate a public/private key pair for each player
	\item Pick a poisson-distributed round to be the final round
	\item Compute secret shares based on any secret sharing scheme (e.g. shamir)
	\item Compute a masked share for each player 
	\subitem The true share will be revealed on the target round
	\subitem maskedShare = PrivateEncrypt(round + nonce) xor actualShare
	\item Send each player their private key
	\item Broadcast to every player the nonce, commitment, all masked shares, and all public keys
\end{itemize}
\subsection{Player Protocol}
\begin{itemize}
	\item Broadcast this round's potential share to all players
	\subitem potentialShare = PrivateEncrypt(round + nonce)
	\item Verify potential shares received from all players
	\subitem PublicDecrypt(received) == round + nonce
	\subitem Exclude players from future rounds if they send nothing or send invalid potential shares
	\item Unmask the potential shares to compute the potential secret
	\subitem unmaskedShare(p) = receivedValue(p) xor maskedShare(p)
	\subitem potentialSecret = combine(unmaskedShares)
	\item Start next round if the potential secret doesn't match the commitment
	\item Otherwise the secret has been learned
\end{itemize}

\subsection{Properties}
\begin{itemize}
	\item Players can't know if a round is the last round before sending their share for that round.
	\subitem Sends are synchronized and other shares must be received in order to create the potential secret in order to compare against the commitment.
	\item Rational players stay honest, even in collusions of size m-1.
	\item Irrational players just drop out immediately, even in collusions of size n-m.
	\item These bounds are the best possible.
	\item Works for n>=m, m>=2 (e.g. n=2 m=2 will work).
	\item O(N) shared values, O(N) private values
	\item 1 message per player per round to all players
	\item O(N) computational cost per round
	\item Cost per round has a much smaller constant than using homomorphic encryption.
	\item Optimal resilience against chaotic players. As long as m players follow the protocol, the secret is learned.
\end{itemize}

\subsection{Correctness}

If a player defects before the last round, they do not learn the secret.

If a player defects on the last round, others may be prevented from learning the secret.

A player can't determine if a round is the final round before deciding to defect, because they need other players' round shares to determine if it's the last round.

A rational player will not defect, because they prefer to learn the secret and won't chance defecting on the incorrect round.

\section{Non-Synchronous Broadcast}

All previous papers have relied upon the assumption of synchronous broadcast. Essentially, the ability to guarantee multiple players send messages before receiving messages sent by other players. This assumption is not very practical.

Losing the synchronous broadcast assumption has costs. Fewer players will learn the secret, and coalitions become more powerful. Examples with proof below.

\subsection{If all players are rational then at least one will not learn the secret}
\begin{itemize}
  \item Let all players be rational
  \item Assume there exists a first round R where all players know the secret, $R >= M-1$
  \subitem Let $S$ be the sender of round R's message
  \subitem $S$ knows the secret in round R
  \subsubitem By definition of R
  \subitem $S$ learned no new information during round R
  \subsubitem $S$ only sent information
  \subitem $S$ knew the secret in round R-1
  \subsubitem $S$ had the same information then
  \subitem $S$ rationally prefers fewer players to learn the secret 
  \subsubitem By definition
  \subitem For $S$, not sending the message weakly dominates sending the message
  \subsubitem $S$ knows the secret either way
  \subsubitem $S$ knows sending messages may reveal the secret to more players
  \subitem $S$ will not send a message in round R
  \subitem $S$ sent a message in round R
  \subitem Contradiction
  \item There is no first round where all players learn the secret
  \subitem By contradiction
  \item At least one player doesn't learn the secret
\end{itemize}

Note that we can achieve exactly one player not learning the secret in the absence of coalitions, meaning the bound is tight. The algorithm will be explored later.

\subsection{Coalitions have a chance of learning the secret earlier}
\begin{itemize}
  \item Let $R$ be the first round where any player learns the secret legitimately (assuming no collusion), $R >= M-1$
  \item Let $C$ be a set of players in a rational coalition, $1 < |C| < M$
  \item Let $L$ be the set of players who learn the secret in round $R$, $L \not = \emptyset$.
  \item Let $S$ be the sender of round R's message
  \item $S \not \in L$
    \subitem S learned no new information during round R
  \item $R >= |C|$
    \subitem By $R >= M-1$, $|C| < M$
  \item If $L \cap S \not = \emptyset and S \in C$ then in round R-1 the coalition knows the information necessary to reconstruct the secret.
  \item $P(L \cap S \not = \emptyset and S \in C) >= \frac{|C|*(|C|-1)}{N*(N-1)}$
  	\subitem $P(S \in C) = \frac{|C|}{N}$
    \subitem If $|L| = 1$ then $P(L \cap S \not = \emptyset | S \in C) = \frac{|C|-1}{N}$
    \subitem If $|L| = 1$ then $P(L \cap S \not = \emptyset and S \in C) = \frac{|C|*(|C|-1)}{N*(N-1)}$
  \item Therefore there is at least a $\frac{|C|*(|C|-1)}{N*(N-1)}$ chance colluders will learn the secret at least one round early.
  \item If $N - C < M$ then also others will not learn the secret with that probability, since the coalition will stop participating. 
\end{itemize}



\subsection{Algorithm}

Differences from synchronous algorithm:

Rounds have H senders instead of all at once. Players will learn the secret H at a time, the round after they send. This is made possible by giving each player a different set of shares to reveal (i.e. they get different masks to apply), and making the masks apply on different rounds.

GRAPHIC

$H = 1$

$M = 3$

$N = 5$

Receivers

  Sender

. 1 2 3 4 5 1 2
  
2 + + + + + . x 5/5 pass

3 . + + + + + x 5/5 pass

4 . . + + + + x 4/5 pass

5 . . . + + + x 3/5 pass

1 . . . . + + x 2/5 fail



$H = 2$

$M = 3$

$N = 5$

Receivers

  Sender

. 61 23 45 61 23
  
2 .+ ++ ++ .. xx 5/5 pass

3 .+ ++ ++ .. xx 5/5 pass

4 .. .+ ++ ++ xx 5/5 pass

5 .. .+ ++ ++ xx 5/5 pass

6 .. .. .+ ++ xx 3/5 pass

1 .. .. .+ ++ xx 3/5 pass

\subsection{Analysis}



\section{limitations}
\section{future work}
\section{Conclusion}
\end{document}
